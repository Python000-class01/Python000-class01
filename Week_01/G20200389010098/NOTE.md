### 运行环境
+ 扩展安装  
扩展安装需要镜像，否则会因为网络问题报错  
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple requests
+ 虚拟环境  
虚拟环境可以让当前目录的python版本、扩展和系统隔离开。  
导出当前安装的扩展 pip freeze > requirements.txt  
安装扩展 pip install -r requirements.txt  
git时可以吧venv文件夹放到.gitignore，只上传requirements.txt保持扩展同步


### 基础知识

箱子法，赋值其实就是指向一块内存，可变类型中的内容变化，但箱子不变  
定义类的默认值时也要注意，不然不同的实例会使用同一个变量  
3.6引入f-string  f"I'am {name}" 性能好，易读
3.8 海象运算符  "：="  
元组推导式要显式的用tuple，（）被生成器占用  
生成器 不必创建完整的list，节省空间

### requests
+ header  
请求时要设置header用来伪装请求，fake_useragent可以很方便的生成ua  
有些时候（下图片）还要设置refer和host，否则会被防盗链  
下载图片大文件时  设置 stream=True，使用chunk分段下载

+ 编码  
win下要设置res.encoding = 'utf-8'  
+ cookie   
1、requests.session 保持统一会话  
2、chromedriver下载可以用淘宝镜像：http://npm.taobao.org/mirrors/chromedriver/

### bs4和xpath
如果要用lxml解析，需要下扩展  
bs4相对人性化，其中的select可以使用纯css查找，但是经过测试比findall慢一倍  
xpath查找几乎没有时间消耗，打印出时间都是0 还是要多练习用xpath，效率太高了

### 多线程相关 
多线程的难点在于多线程对公用变量的访问  
我将作业设计成了抓取数据（生产者），写入数据（消费者），同时希望消费的时候保存文件一直处于打开状态，能避免每次写入的时候都打开文件句柄。这就需要消费者知道生产者已经生产完毕可以退出了。  
一开始我用生产者结束后改变全局变量来判断，但很有可能生产者1发现待采集队列没有数据而自己完成了以后就会改变全局变量，导致消费者也退出，但是生产者2的数据没有被写入  
最后我采用的生产者判断待采集队列为空退出，消费者判断总的线程数（主线程和当前线程）和待写入队列为空时退出  

做了将网页缓存在本地的功能，但是多线程时有可能同事判断到缓存文件夹不存在，同时创建的话就会报错，因此设置了全局变量来，创建成功后就改值保证别的线程不会重复创建


### tk
平时看漫画翻一页要点到很多次广告，想爬下来看  
需求：桌面软件输入链接地址选择保存路径后自动下载  
pip包名叫 pythotk  
感觉和socket很像，启动之后就等待，点击按钮促发事件以后处理
缺点：现在点击采集后按钮就一直处于等待状态，也不能查看下载进度，随着学习的深入可以再迭代下